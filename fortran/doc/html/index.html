<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Modular arbitrary-order ocean-atmosphere model: MAOOAM -- Fortran implementation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MAOOAM_small.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">A Modular Arbitrary-Order Ocean-Atmosphere Model</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Modular arbitrary-order ocean-atmosphere model: MAOOAM -- Fortran implementation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Lyapunov exponents computation version</h2>
<hr/>
<h2>About</h2>
<p>(c) 2013-2016 Lesley De Cruz, Jonathan Demaeyer and Sebastian Schubert</p>
<p>See <a href="../LICENSE.txt">LICENSE.txt</a> for license information.</p>
<p>This software is provided as supplementary material with:</p>
<ul>
<li>De Cruz, L., Demaeyer, J. and Vannitsem, S.: The Modular Arbitrary-Order Ocean-Atmosphere Model: MAOOAM v1.0, Geosci. Model Dev., 9, 2793-2808, <a href="http://dx.doi.org/10.5194/gmd-9-2793-2016">doi:10.5194/gmd-9-2793-2016</a>, 2016.</li>
</ul>
<p><b>Please cite this article if you use (a part of) this software for a publication.</b></p>
<p>The authors would appreciate it if you could also send a reprint of your paper to <a href="#" onclick="location.href='mai'+'lto:'+'les'+'le'+'y.d'+'ec'+'ruz'+'@m'+'ete'+'o.'+'be'; return false;">lesle<span style="display: none;">.nosp@m.</span>y.de<span style="display: none;">.nosp@m.</span>cruz@<span style="display: none;">.nosp@m.</span>mete<span style="display: none;">.nosp@m.</span>o.be</a>, <a href="#" onclick="location.href='mai'+'lto:'+'jon'+'at'+'han'+'.d'+'ema'+'ey'+'er@'+'me'+'teo'+'.b'+'e'; return false;">jonat<span style="display: none;">.nosp@m.</span>han.<span style="display: none;">.nosp@m.</span>demae<span style="display: none;">.nosp@m.</span>yer@<span style="display: none;">.nosp@m.</span>meteo<span style="display: none;">.nosp@m.</span>.be</a> and <a href="#" onclick="location.href='mai'+'lto:'+'svn'+'@m'+'ete'+'o.'+'be'; return false;">svn@m<span style="display: none;">.nosp@m.</span>eteo<span style="display: none;">.nosp@m.</span>.be</a>.</p>
<p>Consult the MAOOAM <a href="http://www.github.com/Climdyn/MAOOAM">code repository</a> for updates, and <a href="http://climdyn.meteo.be">our website</a> for additional resources.</p>
<p>A pdf version of this manual is available <a href="../latex/Reference_manual.pdf">here</a>. </p><hr/>
<h2>Note on the Lyapunov exponents computation</h2>
<p>This version of the code allows for the computation of the backward Lyapunov exponents. The method used is described in</p>
<ul>
<li>Benettin, G., Galgani, L., Giorgilli, A., and Strelcyn, J. M. : Lyapunov characteristic exponents for smooth dynamical systems; a method for computing all of them. Part 2: Numerical application. Meccanica, 15, 21-30, <a href="http://dx.doi.org/10.1007/BF02128237">doi:10.1007/BF02128237</a>, 1980.</li>
</ul>
<p>This version has been used to compute the Lyapunov exponents of MAOOAM in the following manuscript:</p>
<ul>
<li>De Cruz, L., Schubert, S., Demaeyer, J., Lucarini, V., and Vannitsem, S.: Exploring the Lyapunov instability properties of high-dimensional atmospheric and climate models, Nonlin. Processes Geophys. Discuss., <a href="https://doi.org/10.5194/npg-2017-76">doi:10.5194/npg-2017-76</a>, in review, 2018. <hr/>
</li>
</ul>
<h2>Installation</h2>
<p>The program can be installed with Makefile. We provide configuration files for two compilers : gfortran and ifort.</p>
<p>By default, gfortran is selected. To select one or the other, simply modify the Makefile accordingly or pass the COMPILER flag to <code>make</code>. If gfortran is selected, the code should be compiled with gfortran 4.7+ (allows for allocatable arrays in namelists). If ifort is selected, the code has been tested with the version 14.0.2 and we do not guarantee compatibility with older compiler version.</p>
<p>To install, unpack the archive in a folder or clone with git:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;git clone https://github.com/Climdyn/MAOOAM.git</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;cd MAOOAM</div></div><!-- fragment --><p>and run:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;make</div></div><!-- fragment --><p> By default, the inner products of the basis functions, used to compute the coefficients of the ODEs, are not stored in memory. If you want to enable the storage in memory of these inner products, run make with the following flag:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;make RES=store</div></div><!-- fragment --><p>Depending on the chosen resolution, storing the inner products may result in a huge memory usage and is not recommended unless you need them for a specific purpose.</p>
<p>Remark: The command "make clean" removes the compiled files.</p>
<p>For Windows users, a minimalistic GNU development environment (including gfortran and make) is available at <a href="http://www.mingw.org">www.mingw.org</a> . </p><hr/>
<h2>Description of the files</h2>
<p>The model tendencies are represented through a tensor called aotensor which includes all the coefficients. This tensor is computed once at the program initialization.</p>
<ul>
<li><a class="el" href="maooam_8f90.html">maooam.f90</a> : Main program.</li>
<li><a class="el" href="maooam__lyap_8f90.html">maooam_lyap.f90</a> : Version of the main program with the computation of the Lyapunov exponents.</li>
<li><a class="el" href="maooam__lyap__div_8f90.html">maooam_lyap_div.f90</a> : Version of the main program with the computation of the first Lyapunov exponents with the divergence method.</li>
<li><a class="el" href="aotensor__def_8f90.html">aotensor_def.f90</a> : Tensor aotensor computation module.</li>
<li><a class="el" href="lyap__vectors_8f90.html">lyap_vectors.f90</a> : Module for the computation of Lyapunov exponents and vectors</li>
<li>IC_def.f90 : A module which loads the user specified initial condition.</li>
<li><a class="el" href="inprod__analytic_8f90.html">inprod_analytic.f90</a> : Inner products computation module.</li>
<li><a class="el" href="rk2__integrator_8f90.html">rk2_integrator.f90</a> : A module which contains the Heun integrator for the model equations.</li>
<li><a class="el" href="rk4__integrator_8f90.html">rk4_integrator.f90</a> : A module which contains the RK4 integrator for the model equations.</li>
<li>Makefile : The Makefile.</li>
<li><a class="el" href="params_8f90.html">params.f90</a> : The model parameters module.</li>
<li><a class="el" href="tl__ad__tensor_8f90.html">tl_ad_tensor.f90</a> : Tangent Linear (TL) and Adjoint (AD) model tensors definition module</li>
<li><a class="el" href="rk2__tl__ad__integrator_8f90.html">rk2_tl_ad_integrator.f90</a> : Heun Tangent Linear (TL) and Adjoint (AD) model integrators module</li>
<li><a class="el" href="rk4__tl__ad__integrator_8f90.html">rk4_tl_ad_integrator.f90</a> : RK4 Tangent Linear (TL) and Adjoint (AD) model integrators module</li>
<li><a class="el" href="test__tl__ad_8f90.html">test_tl_ad.f90</a> : Tests for the Tangent Linear (TL) and Adjoint (AD) model versions</li>
<li>README.md : A read me file.</li>
<li><a class="el" href="LICENSE_8txt.html">LICENSE.txt</a> : The license text of the program.</li>
<li><a class="el" href="util_8f90.html">util.f90</a> : A module with various useful functions.</li>
<li><a class="el" href="tensor_8f90.html">tensor.f90</a> : Tensor utility module.</li>
<li><a class="el" href="stat_8f90.html">stat.f90</a> : A module for statistic accumulation.</li>
<li>params.nml : A namelist to specify the model parameters.</li>
<li>int_params.nml : A namelist to specify the integration parameters.</li>
<li>modeselection.nml : A namelist to specify which spectral decomposition will be used.</li>
</ul>
<hr/>
<h2>Usage</h2>
<p>The user first has to fill the params.nml and int_params.nml namelist files according to their needs. Indeed, model and integration parameters can be specified respectively in the params.nml and int_params.nml namelist files. Some examples related to already published article are available in the params folder.</p>
<p>The parameters related to the Lyapunov exponents computation are located in the int_params.nml namelist file.</p>
<p>The modeselection.nml namelist can then be filled :</p><ul>
<li>NBOC and NBATM specify the number of blocks that will be used in respectively the ocean and the atmosphere. Each block corresponds to a given x and y wavenumber.</li>
<li>The OMS and AMS arrays are integer arrays which specify which wavenumbers of the spectral decomposition will be used in respectively the ocean and the atmosphere. Their shapes are OMS(NBOC,2) and AMS(NBATM,2).</li>
<li>The first dimension specifies the number attributed by the user to the block and the second dimension specifies the x and the y wavenumbers.</li>
<li>The VDDG model, described in Vannitsem et al. (2015) is given as an example in the archive.</li>
<li>Note that the variables of the model are numbered according to the chosen order of the blocks.</li>
</ul>
<p>The Makefile allows to change the integrator being used for the time evolution. The user should modify it according to its need. By default a RK2 scheme is selected.</p>
<p>Finally, the IC.nml file specifying the initial condition should be defined. To obtain an example of this configuration file corresponding to the model you have previously defined, simply delete the current IC.nml file (if it exists) and run the main program : </p><pre class="fragment">./maooam
</pre><p>It will generate a new one and start with the 0 initial condition. If you want another initial condition, stop the program, fill the newly generated file and restart : </p><pre class="fragment">./maooam
</pre><p>It will generate two files :</p><ul>
<li>evol_field.dat : the recorded time evolution of the variables.</li>
<li>mean_field.dat : the mean field (the climatology)</li>
</ul>
<p>The tangent linear and adjoint models of MAOOAM are provided in the <a class="el" href="namespacetl__ad__tensor.html" title="Tangent Linear (TL) and Adjoint (AD) model versions of MAOOAM. Tensors definition module...">tl_ad_tensor</a>, rk2_tl_ad_integrator and rk4_tl_ad_integrator modules. It is documented <a href="./md_doc_tl_ad_doc.html">here</a>.</p>
<p>The computation of the Lyapunov exponents can be done by running the program : </p><pre class="fragment">./maooam_lyap
</pre><p>It will generate four files:</p><ul>
<li>evol_field.dat : the recorded time evolution of the variables.</li>
<li>mean_field.dat : the mean field (the climatology)</li>
<li>lyapunov_exponents.dat : the recorded time evolution of the Lyapunov exponents</li>
<li>mean_lyapunov.dat : the mean Lyapunov exponents as well as their variance.</li>
</ul>
<p>Alternatively, the first Lyapunov exponent can be computed by the divergence method, by running :</p>
<p>./maooam_lyap_div</p>
<p>It will generate three files :</p><ul>
<li>evol_field.dat : the recorded time evolution of the variables.</li>
<li>mean_field.dat : the mean field (the climatology)</li>
<li>lyapunov_exponents_div.dat : the recorded time evolution of the first Lyapunov exponent <hr/>
</li>
</ul>
<h2>Implementation notes</h2>
<p>As the system of differential equations is at most bilinear in \(y_j\) ( \(j=1..n\)), \(\boldsymbol{y}\) being the array of variables, it can be expressed as a tensor contraction :</p>
<p class="formulaDsp">
\[ \frac{d y_i}{dt} = \sum_{j,k=0}^{ndim} \, \mathcal{T}_{i,j,k} \, y_k \; y_j \]
</p>
<p>with \(y_0 = 1\).</p>
<p>The tensor <a class="el" href="namespaceaotensor__def.html#a0dc43bc9294a18f2fe57b67489f1702f" title=" - Tensor representation of the tendencies. ">aotensor_def::aotensor</a> is the tensor \(\mathcal{T}\) that encodes the differential equations is composed so that:</p>
<ul>
<li>\(\mathcal{T}_{i,j,k}\) contains the contribution of \(dy_i/dt\) proportional to \( y_j \, y_k\).</li>
<li>Furthermore, \(y_0\) is always equal to 1, so that \(\mathcal{T}_{i,0,0}\) is the constant contribution to \(dy_i/dt\)</li>
<li>\(\mathcal{T}_{i,j,0} + \mathcal{T}_{i,0,j}\) is the contribution to \(dy_i/dt\) which is linear in \(y_j\).</li>
</ul>
<p>Ideally, the tensor <a class="el" href="namespaceaotensor__def.html#a0dc43bc9294a18f2fe57b67489f1702f" title=" - Tensor representation of the tendencies. ">aotensor_def::aotensor</a> is composed as an upper triangular matrix (in the last two coordinates).</p>
<p>The tensor for this model is composed in the <a class="el" href="namespaceaotensor__def.html" title="The equation tensor for the coupled ocean-atmosphere model with temperature which allows for an exten...">aotensor_def</a> module and uses the inner products defined in the <a class="el" href="namespaceinprod__analytic.html" title="Inner products between the truncated set of basis functions for the ocean and atmosphere streamfuncti...">inprod_analytic</a> module.</p>
<hr/>
<h2>Final Remarks</h2>
<p>The authors would like to thank Kris for help with the lua2fortran project. It has greatly reduced the amount of (error-prone) work.</p>
<p>No animals were harmed during the coding process. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 19 2018 18:11:22 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
