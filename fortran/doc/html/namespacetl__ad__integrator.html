<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>tl_ad_integrator Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="MAOOAM_small.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">A Modular Arbitrary-Order Ocean-Atmosphere Model</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Modules&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Module&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">tl_ad_integrator Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Tangent Linear (TL) and Adjoint (AD) model versions of MAOOAM. Integrators module.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa03be9677761cfa373b15c85cccdc424"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#aa03be9677761cfa373b15c85cccdc424">tendencies</a> (t, y, res)</td></tr>
<tr class="memdesc:aa03be9677761cfa373b15c85cccdc424"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine computing the tendencies of the nonlinear model.  <a href="#aa03be9677761cfa373b15c85cccdc424">More...</a><br /></td></tr>
<tr class="separator:aa03be9677761cfa373b15c85cccdc424"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef5ff45fe5f9b73ceb8d72c195dc381"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#aeef5ff45fe5f9b73ceb8d72c195dc381">init_tl_ad_integrator</a></td></tr>
<tr class="memdesc:aeef5ff45fe5f9b73ceb8d72c195dc381"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to initialise the integration buffers.  <a href="#aeef5ff45fe5f9b73ceb8d72c195dc381">More...</a><br /></td></tr>
<tr class="separator:aeef5ff45fe5f9b73ceb8d72c195dc381"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a708ece5eac01486e65e889d19073fd19"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a708ece5eac01486e65e889d19073fd19">ad_step</a> (y, ystar, t, dt, res)</td></tr>
<tr class="memdesc:a708ece5eac01486e65e889d19073fd19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to perform an integration step (Heun algorithm) of the adjoint model. The incremented time is returned.  <a href="#a708ece5eac01486e65e889d19073fd19">More...</a><br /></td></tr>
<tr class="separator:a708ece5eac01486e65e889d19073fd19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc53f72486953af9fa4ced620eee226f"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#abc53f72486953af9fa4ced620eee226f">evolve_ad_step</a> (y, deltay, t, dt, ynew, deltaynew)</td></tr>
<tr class="memdesc:abc53f72486953af9fa4ced620eee226f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to perform a simultaneous integration step (RK4 algorithm) of the nonlinear and adjoint together. The incremented time is returned.  <a href="#abc53f72486953af9fa4ced620eee226f">More...</a><br /></td></tr>
<tr class="separator:abc53f72486953af9fa4ced620eee226f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac88b155557d4fc0bae70007fde3aef06"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#ac88b155557d4fc0bae70007fde3aef06">tl_step</a> (y, ystar, t, dt, res)</td></tr>
<tr class="memdesc:ac88b155557d4fc0bae70007fde3aef06"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to perform an integration step (Heun algorithm) of the tangent linear model. The incremented time is returned.  <a href="#ac88b155557d4fc0bae70007fde3aef06">More...</a><br /></td></tr>
<tr class="separator:ac88b155557d4fc0bae70007fde3aef06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9fb60b4a88b0c5d6ca27b58440a32f74"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a9fb60b4a88b0c5d6ca27b58440a32f74">evolve_tl_step</a> (y, deltay, t, dt, ynew, deltaynew)</td></tr>
<tr class="memdesc:a9fb60b4a88b0c5d6ca27b58440a32f74"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to perform a simultaneous integration step (RK4 algorithm) of the nonlinear and the tangent linear model together. The incremented time is returned.  <a href="#a9fb60b4a88b0c5d6ca27b58440a32f74">More...</a><br /></td></tr>
<tr class="separator:a9fb60b4a88b0c5d6ca27b58440a32f74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76538a8bd594899e94228abaa34b48cd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a76538a8bd594899e94228abaa34b48cd">prop_step</a> (y, propagator, t, dt, ynew, adjoint)</td></tr>
<tr class="memdesc:a76538a8bd594899e94228abaa34b48cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Routine to perform a simultaneously an integration step (Heun algorithm) of the nonlinear and computes the Heun tangent linear propagator. The boolean variable adjoint allows for an adjoint forward integration. The incremented time is returned.  <a href="#a76538a8bd594899e94228abaa34b48cd">More...</a><br /></td></tr>
<tr class="separator:a76538a8bd594899e94228abaa34b48cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a54c26282330477995b554805fbacf236"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a54c26282330477995b554805fbacf236">buf_y1</a></td></tr>
<tr class="memdesc:a54c26282330477995b554805fbacf236"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model.  <a href="#a54c26282330477995b554805fbacf236">More...</a><br /></td></tr>
<tr class="separator:a54c26282330477995b554805fbacf236"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0e2f29027e4317cae009ca0c4ad1b5a"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#ad0e2f29027e4317cae009ca0c4ad1b5a">buf_f0</a></td></tr>
<tr class="memdesc:ad0e2f29027e4317cae009ca0c4ad1b5a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies at the initial position of the tangent linear model.  <a href="#ad0e2f29027e4317cae009ca0c4ad1b5a">More...</a><br /></td></tr>
<tr class="separator:ad0e2f29027e4317cae009ca0c4ad1b5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac466cd6f698dc9fed5fc3ab46f30b9a5"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#ac466cd6f698dc9fed5fc3ab46f30b9a5">buf_f1</a></td></tr>
<tr class="memdesc:ac466cd6f698dc9fed5fc3ab46f30b9a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies at the intermediate position of the tangent linear model.  <a href="#ac466cd6f698dc9fed5fc3ab46f30b9a5">More...</a><br /></td></tr>
<tr class="separator:ac466cd6f698dc9fed5fc3ab46f30b9a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae17c25e2843c5f18b69c133ccca1d483"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#ae17c25e2843c5f18b69c133ccca1d483">buf_y11</a></td></tr>
<tr class="memdesc:ae17c25e2843c5f18b69c133ccca1d483"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model.  <a href="#ae17c25e2843c5f18b69c133ccca1d483">More...</a><br /></td></tr>
<tr class="separator:ae17c25e2843c5f18b69c133ccca1d483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1d8e51e7ef84e4b5cbab851759fa983"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#ac1d8e51e7ef84e4b5cbab851759fa983">buf_f00</a></td></tr>
<tr class="memdesc:ac1d8e51e7ef84e4b5cbab851759fa983"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies at the initial position of the tangent linear model.  <a href="#ac1d8e51e7ef84e4b5cbab851759fa983">More...</a><br /></td></tr>
<tr class="separator:ac1d8e51e7ef84e4b5cbab851759fa983"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad772309f6a78f335766cec48e65747ba"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#ad772309f6a78f335766cec48e65747ba">buf_f11</a></td></tr>
<tr class="memdesc:ad772309f6a78f335766cec48e65747ba"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies at the intermediate position of the tangent linear model.  <a href="#ad772309f6a78f335766cec48e65747ba">More...</a><br /></td></tr>
<tr class="separator:ad772309f6a78f335766cec48e65747ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf7d3c46036ca20cca151adc20a2fa14"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#abf7d3c46036ca20cca151adc20a2fa14">buf_j1</a></td></tr>
<tr class="memdesc:abf7d3c46036ca20cca151adc20a2fa14"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#abf7d3c46036ca20cca151adc20a2fa14">More...</a><br /></td></tr>
<tr class="separator:abf7d3c46036ca20cca151adc20a2fa14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ce53a275fcb35f76e2b34ee8d8df1ca"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a0ce53a275fcb35f76e2b34ee8d8df1ca">buf_j2</a></td></tr>
<tr class="memdesc:a0ce53a275fcb35f76e2b34ee8d8df1ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#a0ce53a275fcb35f76e2b34ee8d8df1ca">More...</a><br /></td></tr>
<tr class="separator:a0ce53a275fcb35f76e2b34ee8d8df1ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae89c821542838ecfc5ac3b7a76d5c1"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a4ae89c821542838ecfc5ac3b7a76d5c1">buf_j1h</a></td></tr>
<tr class="memdesc:a4ae89c821542838ecfc5ac3b7a76d5c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#a4ae89c821542838ecfc5ac3b7a76d5c1">More...</a><br /></td></tr>
<tr class="separator:a4ae89c821542838ecfc5ac3b7a76d5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a5e4cbc6f573f1274e53cbb4607f5bb"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a2a5e4cbc6f573f1274e53cbb4607f5bb">buf_j2h</a></td></tr>
<tr class="memdesc:a2a5e4cbc6f573f1274e53cbb4607f5bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#a2a5e4cbc6f573f1274e53cbb4607f5bb">More...</a><br /></td></tr>
<tr class="separator:a2a5e4cbc6f573f1274e53cbb4607f5bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08f375467a942d0ad466b407a8007a7e"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a08f375467a942d0ad466b407a8007a7e">one</a></td></tr>
<tr class="memdesc:a08f375467a942d0ad466b407a8007a7e"><td class="mdescLeft">&#160;</td><td class="mdescRight">unit matrix  <a href="#a08f375467a942d0ad466b407a8007a7e">More...</a><br /></td></tr>
<tr class="separator:a08f375467a942d0ad466b407a8007a7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a879cc86c1e268775237b6776a4ff7d32"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a879cc86c1e268775237b6776a4ff7d32">buf_ka</a></td></tr>
<tr class="memdesc:a879cc86c1e268775237b6776a4ff7d32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies in the RK4 scheme for the tangent linear model.  <a href="#a879cc86c1e268775237b6776a4ff7d32">More...</a><br /></td></tr>
<tr class="separator:a879cc86c1e268775237b6776a4ff7d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd6a1c209bc0120ea4e1e473e067a902"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#abd6a1c209bc0120ea4e1e473e067a902">buf_kb</a></td></tr>
<tr class="memdesc:abd6a1c209bc0120ea4e1e473e067a902"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies in the RK4 scheme for the tangent linear model.  <a href="#abd6a1c209bc0120ea4e1e473e067a902">More...</a><br /></td></tr>
<tr class="separator:abd6a1c209bc0120ea4e1e473e067a902"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cf59efa7229b47e580202dfe4bd4fd6"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a1cf59efa7229b47e580202dfe4bd4fd6">buf_kc</a></td></tr>
<tr class="memdesc:a1cf59efa7229b47e580202dfe4bd4fd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies in the RK4 scheme for the tangent linear model.  <a href="#a1cf59efa7229b47e580202dfe4bd4fd6">More...</a><br /></td></tr>
<tr class="separator:a1cf59efa7229b47e580202dfe4bd4fd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b72ebc24a7e0eb44e22e6489ac81ed3"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a3b72ebc24a7e0eb44e22e6489ac81ed3">buf_kd</a></td></tr>
<tr class="memdesc:a3b72ebc24a7e0eb44e22e6489ac81ed3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies in the RK4 scheme for the tangent linear model.  <a href="#a3b72ebc24a7e0eb44e22e6489ac81ed3">More...</a><br /></td></tr>
<tr class="separator:a3b72ebc24a7e0eb44e22e6489ac81ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb500987b643ce33b2a549ba213221fc"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#afb500987b643ce33b2a549ba213221fc">buf_j3</a></td></tr>
<tr class="memdesc:afb500987b643ce33b2a549ba213221fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#afb500987b643ce33b2a549ba213221fc">More...</a><br /></td></tr>
<tr class="separator:afb500987b643ce33b2a549ba213221fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853bee458e7337f1556f19370dcbc9d6"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a853bee458e7337f1556f19370dcbc9d6">buf_j4</a></td></tr>
<tr class="memdesc:a853bee458e7337f1556f19370dcbc9d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#a853bee458e7337f1556f19370dcbc9d6">More...</a><br /></td></tr>
<tr class="separator:a853bee458e7337f1556f19370dcbc9d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ead2c02f871be0e94e91278fa71337c"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a9ead2c02f871be0e94e91278fa71337c">buf_j3h</a></td></tr>
<tr class="memdesc:a9ead2c02f871be0e94e91278fa71337c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#a9ead2c02f871be0e94e91278fa71337c">More...</a><br /></td></tr>
<tr class="separator:a9ead2c02f871be0e94e91278fa71337c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99c2747c1997b622f4ab6170e3a8f23d"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a99c2747c1997b622f4ab6170e3a8f23d">buf_j4h</a></td></tr>
<tr class="memdesc:a99c2747c1997b622f4ab6170e3a8f23d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold jacobians in the RK4 scheme for the tangent linear model.  <a href="#a99c2747c1997b622f4ab6170e3a8f23d">More...</a><br /></td></tr>
<tr class="separator:a99c2747c1997b622f4ab6170e3a8f23d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24b147c589eb6bdb6175c56657aff5ae"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a24b147c589eb6bdb6175c56657aff5ae">buf_kaa</a></td></tr>
<tr class="memdesc:a24b147c589eb6bdb6175c56657aff5ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies in the RK4 scheme for the tangent linear model.  <a href="#a24b147c589eb6bdb6175c56657aff5ae">More...</a><br /></td></tr>
<tr class="separator:a24b147c589eb6bdb6175c56657aff5ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68ad95731421a7e0c9f37668631e279c"><td class="memItemLeft" align="right" valign="top">real(kind=8), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacetl__ad__integrator.html#a68ad95731421a7e0c9f37668631e279c">buf_kbb</a></td></tr>
<tr class="memdesc:a68ad95731421a7e0c9f37668631e279c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Buffer to hold tendencies in the RK4 scheme for the tangent linear model.  <a href="#a68ad95731421a7e0c9f37668631e279c">More...</a><br /></td></tr>
<tr class="separator:a68ad95731421a7e0c9f37668631e279c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Tangent Linear (TL) and Adjoint (AD) model versions of MAOOAM. Integrators module. </p>
<dl class="section copyright"><dt>Copyright</dt><dd>2016 Lesley De Cruz, Jonathan Demaeyer &amp; Sebastian Schubert. See <a class="el" href="LICENSE_8txt.html">LICENSE.txt</a> for license information. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This module actually contains the Heun algorithm routines. The user can modify it according to its preferred integration scheme. For higher-order schemes, additional buffers will probably have to be defined.</dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>2016 Lesley De Cruz, Jonathan Demaeyer &amp; Sebastian Schubert. See <a class="el" href="LICENSE_8txt.html">LICENSE.txt</a> for license information. </dd></dl>
<dl class="section remark"><dt>Remarks</dt><dd>This module actually contains the RK4 algorithm routines. The user can modify it according to its preferred integration scheme. For higher-order schemes, additional bufers will probably have to be defined. </dd></dl>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="a708ece5eac01486e65e889d19073fd19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public tl_ad_integrator::ad_step </td>
          <td>(</td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>ystar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(inout)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to perform an integration step (Heun algorithm) of the adjoint model. The incremented time is returned. </p>
<p>Routine to perform an integration step (RK4 algorithm) of the adjoint model. The incremented time is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>Initial point. </td></tr>
    <tr><td class="paramname">ystar</td><td>Adjoint model at the point ystar. </td></tr>
    <tr><td class="paramname">t</td><td>Actual integration time </td></tr>
    <tr><td class="paramname">dt</td><td>Integration timestep. </td></tr>
    <tr><td class="paramname">res</td><td>Final point after the step. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00092">92</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(IN)</span> :: y,ystar</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: t</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(IN)</span> :: dt</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: res</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    </div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keyword">CALL </span>ad(t,ystar,y,buf_f0)</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    buf_y1 = y+dt*buf_f0</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">CALL </span>ad(t+dt,ystar,buf_y1,buf_f1)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    res=y+0.5*(buf_f0+buf_f1)*dt</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    t=t+dt</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abc53f72486953af9fa4ced620eee226f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public tl_ad_integrator::evolve_ad_step </td>
          <td>(</td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>deltay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(inout)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>ynew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>deltaynew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to perform a simultaneous integration step (RK4 algorithm) of the nonlinear and adjoint together. The incremented time is returned. </p>
<p>Routine to perform a simultaneous integration step (RK4 algorithm) of the nonlinear and adjoint model together. The incremented time is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>Model variable at time t </td></tr>
    <tr><td class="paramname">deltay</td><td>Perturbation at time t </td></tr>
    <tr><td class="paramname">t</td><td>Actual integration time </td></tr>
    <tr><td class="paramname">dt</td><td>Integration timestep. </td></tr>
    <tr><td class="paramname">ynew</td><td>Model variable at time t+dt </td></tr>
    <tr><td class="paramname">deltaynew</td><td>Perturbation at time t+dt </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00112">112</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(IN)</span> :: y,deltay</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: t</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(IN)</span> :: dt</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ynew,deltaynew</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keyword">CALL </span>tendencies(t,y,buf_f0)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keyword">CALL </span>ad(t,y,deltay,buf_f00)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    buf_y1 = y + dt*buf_f0</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    buf_y11 = deltay + dt*buf_f00</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keyword">CALL </span>tendencies(t+dt,buf_y1,buf_f1)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keyword">CALL </span>ad(t+dt,buf_y1,buf_y11,buf_f11)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    </div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    t=t+dt</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    ynew=y+0.5*(buf_f0+buf_f1)*dt</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    deltaynew=deltay+0.5*(buf_f00+buf_f11)*dt</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9fb60b4a88b0c5d6ca27b58440a32f74"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public tl_ad_integrator::evolve_tl_step </td>
          <td>(</td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>deltay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(inout)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>ynew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>deltaynew</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to perform a simultaneous integration step (RK4 algorithm) of the nonlinear and the tangent linear model together. The incremented time is returned. </p>
<p>Routine to perform a simultaneous integration step (RK4 algorithm) of the nonlinear and tangent linear model togheter. The incremented time is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>Model variable at time t </td></tr>
    <tr><td class="paramname">deltay</td><td>Perturbation at time t </td></tr>
    <tr><td class="paramname">t</td><td>Actual integration time </td></tr>
    <tr><td class="paramname">dt</td><td>Integration timestep. </td></tr>
    <tr><td class="paramname">ynew</td><td>Model variable at time t+dt </td></tr>
    <tr><td class="paramname">deltaynew</td><td>Perturbation at time t+dt </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00165">165</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(IN)</span> :: y,deltay</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: t</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(IN)</span> :: dt</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ynew,deltaynew</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keyword">CALL </span>tendencies(t,y,buf_f0)</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="keyword">CALL </span>ad(t,y,deltay,buf_f00)</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    buf_y1 = y + dt*buf_f0</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    buf_y11 = deltay + dt*buf_f00</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="keyword">CALL </span>tendencies(t+dt,buf_y1,buf_f1)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">CALL </span>ad(t+dt,buf_y1,buf_y11,buf_f11)</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    </div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    t=t+dt</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    ynew=y+0.5*(buf_f0+buf_f1)*dt</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    deltaynew=deltay+0.5*(buf_f00+buf_f11)*dt</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeef5ff45fe5f9b73ceb8d72c195dc381"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public tl_ad_integrator::init_tl_ad_integrator </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to initialise the integration buffers. </p>
<p>Routine to initialise the TL-AD integration bufers. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00068">68</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordtype">INTEGER</span> :: allocstat</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keyword">ALLOCATE</span>(buf_y1(0:ndim),buf_f0(0:ndim),buf_f1(0:ndim),&amp;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;         &amp;buf_y11(0:ndim),buf_f00(0:ndim),buf_f11(0:ndim),&amp;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;         &amp;buf_j1(ndim,ndim),buf_j2(ndim,ndim),one(ndim,ndim),&amp;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;         &amp;buf_j1h(ndim,ndim),buf_j2h(ndim,ndim),<a class="code" href="namespacestat.html">stat</a>=allocstat)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">IF</span> (allocstat /= 0) stop <span class="stringliteral">&quot;*** Not enough memory ! ***&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="keyword">CALL </span>init_one(one)</div><div class="ttc" id="namespacestat_html"><div class="ttname"><a href="namespacestat.html">stat</a></div><div class="ttdoc">Statistics accumulators. </div><div class="ttdef"><b>Definition:</b> <a href="stat_8f90_source.html#l00014">stat.f90:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a76538a8bd594899e94228abaa34b48cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public tl_ad_integrator::prop_step </td>
          <td>(</td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(ndim,ndim), intent(out)&#160;</td>
          <td class="paramname"><em>propagator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(inout)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>ynew</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>adjoint</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to perform a simultaneously an integration step (Heun algorithm) of the nonlinear and computes the Heun tangent linear propagator. The boolean variable adjoint allows for an adjoint forward integration. The incremented time is returned. </p>
<p>Routine to perform a simultaneously an integration step (RK4 algorithm) of the nonlinear and computes the RK4 tangent linear propagator. The boolean variable adjoint allows for an adjoint forward integration. The incremented time is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>Model variable at time t </td></tr>
    <tr><td class="paramname">propagator</td><td>Propagator at time t </td></tr>
    <tr><td class="paramname">t</td><td>Actual integration time </td></tr>
    <tr><td class="paramname">dt</td><td>Integration timestep. </td></tr>
    <tr><td class="paramname">ynew</td><td>Model variable at time t+dt </td></tr>
    <tr><td class="paramname">adjoint</td><td>If true, compute the propagator of the adjoint model (AD) instead of the tangent one (TL)</td></tr>
    <tr><td class="paramname">y</td><td>Model variable at time t </td></tr>
    <tr><td class="paramname">propagator</td><td>Propagator at time t </td></tr>
    <tr><td class="paramname">t</td><td>Actual integration time </td></tr>
    <tr><td class="paramname">dt</td><td>Integration timestep </td></tr>
    <tr><td class="paramname">ynew</td><td>Model variable at time t+dt </td></tr>
    <tr><td class="paramname">adjoint</td><td>If true, compute the propagator of the adjoint model (AD) instead of the tangent one (TL) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00193">193</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: t</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(IN)</span> :: dt</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(IN)</span> :: y</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordtype">LOGICAL</span>, <span class="keywordtype">INTENT(IN)</span> :: adjoint</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(ndim,ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: propagator</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: ynew</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">CALL </span>tendencies(t,y,buf_f0)</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    buf_j1=jacobian_mat(y)</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    buf_y1 = y + dt*buf_f0</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keyword">CALL </span>tendencies(t+dt,buf_y1,buf_f1)</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    buf_j2=jacobian_mat(buf_y1)</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    </div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    buf_j1h=buf_j1</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    buf_j2h=buf_j2</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keyword">CALL </span>dgemm (<span class="stringliteral">&#39;n&#39;</span>, <span class="stringliteral">&#39;n&#39;</span>, ndim, ndim, ndim, dt, buf_j2, ndim,buf_j1h, ndim,1.0d0, buf_j2h, ndim)</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;     </div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    ynew=y  + dt/2.0d0*(buf_f0 + buf_f1)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">IF</span> (adjoint) <span class="keywordflow">THEN</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            propagator=one - dt/2.0d0*(buf_j1h + buf_j2h)</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">ELSE</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            propagator=one + dt/2.0d0*(buf_j1h + buf_j2h)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keywordflow">    END IF</span>        </div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    t=t+dt</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   </div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa03be9677761cfa373b15c85cccdc424"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tl_ad_integrator::tendencies </td>
          <td>(</td>
          <td class="paramtype">real(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Routine computing the tendencies of the nonlinear model. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>Time at which the tendencies have to be computed. Actually not needed for autonomous systems. </td></tr>
    <tr><td class="paramname">y</td><td>Point at which the tendencies have to be computed. </td></tr>
    <tr><td class="paramname">res</td><td>vector to store the result. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section remark"><dt>Remarks</dt><dd>Note that it is NOT safe to pass <code>y</code> as a result bufer, as this operation does multiple passes. </dd></dl>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00060">60</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(IN)</span> :: t</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(IN)</span> :: y</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: res</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">CALL </span>sparse_mul3(aotensor, y, y, res)</div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac88b155557d4fc0bae70007fde3aef06"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine public tl_ad_integrator::tl_step </td>
          <td>(</td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(in)&#160;</td>
          <td class="paramname"><em>ystar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(inout)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(kind=8), dimension(0:ndim), intent(out)&#160;</td>
          <td class="paramname"><em>res</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Routine to perform an integration step (Heun algorithm) of the tangent linear model. The incremented time is returned. </p>
<p>Routine to perform an integration step (RK4 algorithm) of the tangent linear model. The incremented time is returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">y</td><td>Initial point. </td></tr>
    <tr><td class="paramname">ystar</td><td>Adjoint model at the point ystar. </td></tr>
    <tr><td class="paramname">t</td><td>Actual integration time </td></tr>
    <tr><td class="paramname">dt</td><td>Integration timestep. </td></tr>
    <tr><td class="paramname">res</td><td>Final point after the step. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00145">145</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(IN)</span> :: y,ystar</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(INOUT)</span> :: t</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">INTENT(IN)</span> :: dt</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(0:ndim)</span>, <span class="keywordtype">INTENT(OUT)</span> :: res</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keyword">CALL </span>tl(t,ystar,y,buf_f0)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    buf_y1 = y+dt*buf_f0</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="keyword">CALL </span>tl(t+dt,ystar,buf_y1,buf_f1)</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    res=y+0.5*(buf_f0+buf_f1)*dt</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    t=t+dt</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ad0e2f29027e4317cae009ca0c4ad1b5a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_f0</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies at the initial position of the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00035">35</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_f0<span class="comment"> !&lt; Buffer to hold tendencies at the initial position of the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac1d8e51e7ef84e4b5cbab851759fa983"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_f00</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies at the initial position of the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00039">39</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_f00<span class="comment"> !&lt; Buffer to hold tendencies at the initial position of the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac466cd6f698dc9fed5fc3ab46f30b9a5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_f1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies at the intermediate position of the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00036">36</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_f1<span class="comment"> !&lt; Buffer to hold tendencies at the intermediate position of the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad772309f6a78f335766cec48e65747ba"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_f11</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies at the intermediate position of the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00040">40</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_f11<span class="comment"> !&lt; Buffer to hold tendencies at the intermediate position of the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abf7d3c46036ca20cca151adc20a2fa14"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00042">42</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j1<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4ae89c821542838ecfc5ac3b7a76d5c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j1h</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00044">44</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j1h<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0ce53a275fcb35f76e2b34ee8d8df1ca"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j2</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00043">43</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j2<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2a5e4cbc6f573f1274e53cbb4607f5bb"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j2h</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00045">45</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j2h<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afb500987b643ce33b2a549ba213221fc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j3</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00042">42</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j3<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9ead2c02f871be0e94e91278fa71337c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j3h</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00046">46</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j3h<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a853bee458e7337f1556f19370dcbc9d6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j4</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00043">43</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j4<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a99c2747c1997b622f4ab6170e3a8f23d"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::buf_j4h</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold jacobians in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00047">47</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_j4h<span class="comment"> !&lt; Buffer to hold jacobians in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a879cc86c1e268775237b6776a4ff7d32"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_ka</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00035">35</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_ka<span class="comment"> !&lt; Buffer to hold tendencies in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a24b147c589eb6bdb6175c56657aff5ae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_kaa</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00048">48</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_kaa<span class="comment"> !&lt; Buffer to hold tendencies in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd6a1c209bc0120ea4e1e473e067a902"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_kb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00036">36</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_kb<span class="comment"> !&lt; Buffer to hold tendencies in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a68ad95731421a7e0c9f37668631e279c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_kbb</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00049">49</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_kbb<span class="comment"> !&lt; Buffer to hold tendencies in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1cf59efa7229b47e580202dfe4bd4fd6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_kc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00038">38</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_kc<span class="comment"> !&lt; Buffer to hold tendencies in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3b72ebc24a7e0eb44e22e6489ac81ed3"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_kd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold tendencies in the RK4 scheme for the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk4__tl__ad__integrator_8f90_source.html#l00039">39</a> of file <a class="el" href="rk4__tl__ad__integrator_8f90_source.html">rk4_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_kd<span class="comment"> !&lt; Buffer to hold tendencies in the RK4 scheme for the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a54c26282330477995b554805fbacf236"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_y1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model. </p>
<p>Buffer to hold the intermediate position of the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00034">34</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_y1<span class="comment"> !&lt; Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae17c25e2843c5f18b69c133ccca1d483"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:), allocatable tl_ad_integrator::buf_y11</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model. </p>
<p>Buffer to hold the intermediate position of the tangent linear model. </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00038">38</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: buf_y11<span class="comment"> !&lt; Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model</span></div></div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a08f375467a942d0ad466b407a8007a7e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real(kind=8), dimension(:,:), allocatable tl_ad_integrator::one</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>unit matrix </p>

<p>Definition at line <a class="el" href="rk2__tl__ad__integrator_8f90_source.html#l00046">46</a> of file <a class="el" href="rk2__tl__ad__integrator_8f90_source.html">rk2_tl_ad_integrator.f90</a>.</p>
<div class="fragment"><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordtype">REAL(KIND=8)</span>, <span class="keywordtype">DIMENSION(:,:)</span>, <span class="keywordtype">ALLOCATABLE</span> :: one<span class="comment">        !&lt; unit matrix </span></div></div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 19 2018 18:11:22 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
