\hypertarget{namespacetl__ad__integrator}{}\section{tl\+\_\+ad\+\_\+integrator Module Reference}
\label{namespacetl__ad__integrator}\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}


Tangent Linear (TL) and Adjoint (AD) model versions of M\+A\+O\+O\+AM. Integrators module.  


\subsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine \hyperlink{namespacetl__ad__integrator_aa03be9677761cfa373b15c85cccdc424}{tendencies} (t, y, res)
\begin{DoxyCompactList}\small\item\em Routine computing the tendencies of the nonlinear model. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetl__ad__integrator_aeef5ff45fe5f9b73ceb8d72c195dc381}{init\+\_\+tl\+\_\+ad\+\_\+integrator}
\begin{DoxyCompactList}\small\item\em Routine to initialise the integration buffers. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetl__ad__integrator_a708ece5eac01486e65e889d19073fd19}{ad\+\_\+step} (y, ystar, t, dt, res)
\begin{DoxyCompactList}\small\item\em Routine to perform an integration step (Heun algorithm) of the adjoint model. The incremented time is returned. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetl__ad__integrator_abc53f72486953af9fa4ced620eee226f}{evolve\+\_\+ad\+\_\+step} (y, deltay, t, dt, ynew, deltaynew)
\begin{DoxyCompactList}\small\item\em Routine to perform a simultaneous integration step (R\+K4 algorithm) of the nonlinear and adjoint together. The incremented time is returned. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetl__ad__integrator_ac88b155557d4fc0bae70007fde3aef06}{tl\+\_\+step} (y, ystar, t, dt, res)
\begin{DoxyCompactList}\small\item\em Routine to perform an integration step (Heun algorithm) of the tangent linear model. The incremented time is returned. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetl__ad__integrator_a9fb60b4a88b0c5d6ca27b58440a32f74}{evolve\+\_\+tl\+\_\+step} (y, deltay, t, dt, ynew, deltaynew)
\begin{DoxyCompactList}\small\item\em Routine to perform a simultaneous integration step (R\+K4 algorithm) of the nonlinear and the tangent linear model together. The incremented time is returned. \end{DoxyCompactList}\item 
subroutine, public \hyperlink{namespacetl__ad__integrator_a76538a8bd594899e94228abaa34b48cd}{prop\+\_\+step} (y, propagator, t, dt, ynew, adjoint)
\begin{DoxyCompactList}\small\item\em Routine to perform a simultaneously an integration step (Heun algorithm) of the nonlinear and computes the Heun tangent linear propagator. The boolean variable adjoint allows for an adjoint forward integration. The incremented time is returned. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_a54c26282330477995b554805fbacf236}{buf\+\_\+y1}
\begin{DoxyCompactList}\small\item\em Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_ad0e2f29027e4317cae009ca0c4ad1b5a}{buf\+\_\+f0}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies at the initial position of the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_ac466cd6f698dc9fed5fc3ab46f30b9a5}{buf\+\_\+f1}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies at the intermediate position of the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_ae17c25e2843c5f18b69c133ccca1d483}{buf\+\_\+y11}
\begin{DoxyCompactList}\small\item\em Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_ac1d8e51e7ef84e4b5cbab851759fa983}{buf\+\_\+f00}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies at the initial position of the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_ad772309f6a78f335766cec48e65747ba}{buf\+\_\+f11}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies at the intermediate position of the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_abf7d3c46036ca20cca151adc20a2fa14}{buf\+\_\+j1}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_a0ce53a275fcb35f76e2b34ee8d8df1ca}{buf\+\_\+j2}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_a4ae89c821542838ecfc5ac3b7a76d5c1}{buf\+\_\+j1h}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_a2a5e4cbc6f573f1274e53cbb4607f5bb}{buf\+\_\+j2h}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_a08f375467a942d0ad466b407a8007a7e}{one}
\begin{DoxyCompactList}\small\item\em unit matrix \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_a879cc86c1e268775237b6776a4ff7d32}{buf\+\_\+ka}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_abd6a1c209bc0120ea4e1e473e067a902}{buf\+\_\+kb}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_a1cf59efa7229b47e580202dfe4bd4fd6}{buf\+\_\+kc}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_a3b72ebc24a7e0eb44e22e6489ac81ed3}{buf\+\_\+kd}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_afb500987b643ce33b2a549ba213221fc}{buf\+\_\+j3}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_a853bee458e7337f1556f19370dcbc9d6}{buf\+\_\+j4}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_a9ead2c02f871be0e94e91278fa71337c}{buf\+\_\+j3h}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:,\+:), allocatable \hyperlink{namespacetl__ad__integrator_a99c2747c1997b622f4ab6170e3a8f23d}{buf\+\_\+j4h}
\begin{DoxyCompactList}\small\item\em Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_a24b147c589eb6bdb6175c56657aff5ae}{buf\+\_\+kaa}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\item 
real(kind=8), dimension(\+:), allocatable \hyperlink{namespacetl__ad__integrator_a68ad95731421a7e0c9f37668631e279c}{buf\+\_\+kbb}
\begin{DoxyCompactList}\small\item\em Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Tangent Linear (TL) and Adjoint (AD) model versions of M\+A\+O\+O\+AM. Integrators module. 

\begin{DoxyCopyright}{Copyright}
2016 Lesley De Cruz, Jonathan Demaeyer \& Sebastian Schubert. See \hyperlink{LICENSE_8txt}{L\+I\+C\+E\+N\+S\+E.\+txt} for license information. 
\end{DoxyCopyright}
\begin{DoxyRemark}{Remarks}
This module actually contains the Heun algorithm routines. The user can modify it according to its preferred integration scheme. For higher-\/order schemes, additional buffers will probably have to be defined.
\end{DoxyRemark}
\begin{DoxyCopyright}{Copyright}
2016 Lesley De Cruz, Jonathan Demaeyer \& Sebastian Schubert. See \hyperlink{LICENSE_8txt}{L\+I\+C\+E\+N\+S\+E.\+txt} for license information. 
\end{DoxyCopyright}
\begin{DoxyRemark}{Remarks}
This module actually contains the R\+K4 algorithm routines. The user can modify it according to its preferred integration scheme. For higher-\/order schemes, additional bufers will probably have to be defined. 
\end{DoxyRemark}


\subsection{Function/\+Subroutine Documentation}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!ad\+\_\+step@{ad\+\_\+step}}
\index{ad\+\_\+step@{ad\+\_\+step}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{ad\+\_\+step(y, ystar, t, dt, res)}{ad_step(y, ystar, t, dt, res)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine public tl\+\_\+ad\+\_\+integrator\+::ad\+\_\+step (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{y, }
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{ystar, }
\item[{real(kind=8), intent(inout)}]{t, }
\item[{real(kind=8), intent(in)}]{dt, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{res}
\end{DoxyParamCaption}
)}\hypertarget{namespacetl__ad__integrator_a708ece5eac01486e65e889d19073fd19}{}\label{namespacetl__ad__integrator_a708ece5eac01486e65e889d19073fd19}


Routine to perform an integration step (Heun algorithm) of the adjoint model. The incremented time is returned. 

Routine to perform an integration step (R\+K4 algorithm) of the adjoint model. The incremented time is returned.


\begin{DoxyParams}{Parameters}
{\em y} & Initial point. \\
\hline
{\em ystar} & Adjoint model at the point ystar. \\
\hline
{\em t} & Actual integration time \\
\hline
{\em dt} & Integration timestep. \\
\hline
{\em res} & Final point after the step. \\
\hline
\end{DoxyParams}


Definition at line 92 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
92     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(IN)} :: y,ystar
93     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(INOUT)} :: t
94     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(IN)} :: dt
95     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(OUT)} :: res
96     
97     \textcolor{keyword}{CALL }ad(t,ystar,y,buf\_f0)
98     buf\_y1 = y+dt*buf\_f0
99     \textcolor{keyword}{CALL }ad(t+dt,ystar,buf\_y1,buf\_f1)
100     res=y+0.5*(buf\_f0+buf\_f1)*dt
101     t=t+dt
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!evolve\+\_\+ad\+\_\+step@{evolve\+\_\+ad\+\_\+step}}
\index{evolve\+\_\+ad\+\_\+step@{evolve\+\_\+ad\+\_\+step}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{evolve\+\_\+ad\+\_\+step(y, deltay, t, dt, ynew, deltaynew)}{evolve_ad_step(y, deltay, t, dt, ynew, deltaynew)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine public tl\+\_\+ad\+\_\+integrator\+::evolve\+\_\+ad\+\_\+step (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{y, }
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{deltay, }
\item[{real(kind=8), intent(inout)}]{t, }
\item[{real(kind=8), intent(in)}]{dt, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{ynew, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{deltaynew}
\end{DoxyParamCaption}
)}\hypertarget{namespacetl__ad__integrator_abc53f72486953af9fa4ced620eee226f}{}\label{namespacetl__ad__integrator_abc53f72486953af9fa4ced620eee226f}


Routine to perform a simultaneous integration step (R\+K4 algorithm) of the nonlinear and adjoint together. The incremented time is returned. 

Routine to perform a simultaneous integration step (R\+K4 algorithm) of the nonlinear and adjoint model together. The incremented time is returned.


\begin{DoxyParams}{Parameters}
{\em y} & Model variable at time t \\
\hline
{\em deltay} & Perturbation at time t \\
\hline
{\em t} & Actual integration time \\
\hline
{\em dt} & Integration timestep. \\
\hline
{\em ynew} & Model variable at time t+dt \\
\hline
{\em deltaynew} & Perturbation at time t+dt \\
\hline
\end{DoxyParams}


Definition at line 112 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
112     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(IN)} :: y,deltay
113     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(INOUT)} :: t
114     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(IN)} :: dt
115     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(OUT)} :: ynew,deltaynew
116 
117     \textcolor{keyword}{CALL }tendencies(t,y,buf\_f0)
118     \textcolor{keyword}{CALL }ad(t,y,deltay,buf\_f00)
119 
120     buf\_y1 = y + dt*buf\_f0
121     buf\_y11 = deltay + dt*buf\_f00
122 
123     \textcolor{keyword}{CALL }tendencies(t+dt,buf\_y1,buf\_f1)
124     \textcolor{keyword}{CALL }ad(t+dt,buf\_y1,buf\_y11,buf\_f11)
125     
126     t=t+dt
127     ynew=y+0.5*(buf\_f0+buf\_f1)*dt
128     deltaynew=deltay+0.5*(buf\_f00+buf\_f11)*dt
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!evolve\+\_\+tl\+\_\+step@{evolve\+\_\+tl\+\_\+step}}
\index{evolve\+\_\+tl\+\_\+step@{evolve\+\_\+tl\+\_\+step}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{evolve\+\_\+tl\+\_\+step(y, deltay, t, dt, ynew, deltaynew)}{evolve_tl_step(y, deltay, t, dt, ynew, deltaynew)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine public tl\+\_\+ad\+\_\+integrator\+::evolve\+\_\+tl\+\_\+step (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{y, }
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{deltay, }
\item[{real(kind=8), intent(inout)}]{t, }
\item[{real(kind=8), intent(in)}]{dt, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{ynew, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{deltaynew}
\end{DoxyParamCaption}
)}\hypertarget{namespacetl__ad__integrator_a9fb60b4a88b0c5d6ca27b58440a32f74}{}\label{namespacetl__ad__integrator_a9fb60b4a88b0c5d6ca27b58440a32f74}


Routine to perform a simultaneous integration step (R\+K4 algorithm) of the nonlinear and the tangent linear model together. The incremented time is returned. 

Routine to perform a simultaneous integration step (R\+K4 algorithm) of the nonlinear and tangent linear model togheter. The incremented time is returned.


\begin{DoxyParams}{Parameters}
{\em y} & Model variable at time t \\
\hline
{\em deltay} & Perturbation at time t \\
\hline
{\em t} & Actual integration time \\
\hline
{\em dt} & Integration timestep. \\
\hline
{\em ynew} & Model variable at time t+dt \\
\hline
{\em deltaynew} & Perturbation at time t+dt \\
\hline
\end{DoxyParams}


Definition at line 165 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
165     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(IN)} :: y,deltay
166     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(INOUT)} :: t
167     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(IN)} :: dt
168     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(OUT)} :: ynew,deltaynew
169 
170     \textcolor{keyword}{CALL }tendencies(t,y,buf\_f0)
171     \textcolor{keyword}{CALL }ad(t,y,deltay,buf\_f00)
172 
173     buf\_y1 = y + dt*buf\_f0
174     buf\_y11 = deltay + dt*buf\_f00
175 
176     \textcolor{keyword}{CALL }tendencies(t+dt,buf\_y1,buf\_f1)
177     \textcolor{keyword}{CALL }ad(t+dt,buf\_y1,buf\_y11,buf\_f11)
178     
179     t=t+dt
180     ynew=y+0.5*(buf\_f0+buf\_f1)*dt
181     deltaynew=deltay+0.5*(buf\_f00+buf\_f11)*dt
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!init\+\_\+tl\+\_\+ad\+\_\+integrator@{init\+\_\+tl\+\_\+ad\+\_\+integrator}}
\index{init\+\_\+tl\+\_\+ad\+\_\+integrator@{init\+\_\+tl\+\_\+ad\+\_\+integrator}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{init\+\_\+tl\+\_\+ad\+\_\+integrator}{init_tl_ad_integrator}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine public tl\+\_\+ad\+\_\+integrator\+::init\+\_\+tl\+\_\+ad\+\_\+integrator (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{namespacetl__ad__integrator_aeef5ff45fe5f9b73ceb8d72c195dc381}{}\label{namespacetl__ad__integrator_aeef5ff45fe5f9b73ceb8d72c195dc381}


Routine to initialise the integration buffers. 

Routine to initialise the T\+L-\/\+AD integration bufers. 

Definition at line 68 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
68     \textcolor{keywordtype}{INTEGER} :: allocstat
69     \textcolor{keyword}{ALLOCATE}(buf\_y1(0:ndim),buf\_f0(0:ndim),buf\_f1(0:ndim),&
70          &buf\_y11(0:ndim),buf\_f00(0:ndim),buf\_f11(0:ndim),&
71          &buf\_j1(ndim,ndim),buf\_j2(ndim,ndim),one(ndim,ndim),&
72          &buf\_j1h(ndim,ndim),buf\_j2h(ndim,ndim),\hyperlink{namespacestat}{stat}=allocstat)
73     \textcolor{keywordflow}{IF} (allocstat /= 0) stop \textcolor{stringliteral}{"*** Not enough memory ! ***"}
74     \textcolor{keyword}{CALL }init\_one(one)
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!prop\+\_\+step@{prop\+\_\+step}}
\index{prop\+\_\+step@{prop\+\_\+step}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{prop\+\_\+step(y, propagator, t, dt, ynew, adjoint)}{prop_step(y, propagator, t, dt, ynew, adjoint)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine public tl\+\_\+ad\+\_\+integrator\+::prop\+\_\+step (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{y, }
\item[{real(kind=8), dimension(ndim,ndim), intent(out)}]{propagator, }
\item[{real(kind=8), intent(inout)}]{t, }
\item[{real(kind=8), intent(in)}]{dt, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{ynew, }
\item[{logical, intent(in)}]{adjoint}
\end{DoxyParamCaption}
)}\hypertarget{namespacetl__ad__integrator_a76538a8bd594899e94228abaa34b48cd}{}\label{namespacetl__ad__integrator_a76538a8bd594899e94228abaa34b48cd}


Routine to perform a simultaneously an integration step (Heun algorithm) of the nonlinear and computes the Heun tangent linear propagator. The boolean variable adjoint allows for an adjoint forward integration. The incremented time is returned. 

Routine to perform a simultaneously an integration step (R\+K4 algorithm) of the nonlinear and computes the R\+K4 tangent linear propagator. The boolean variable adjoint allows for an adjoint forward integration. The incremented time is returned.


\begin{DoxyParams}{Parameters}
{\em y} & Model variable at time t \\
\hline
{\em propagator} & Propagator at time t \\
\hline
{\em t} & Actual integration time \\
\hline
{\em dt} & Integration timestep. \\
\hline
{\em ynew} & Model variable at time t+dt \\
\hline
{\em adjoint} & If true, compute the propagator of the adjoint model (AD) instead of the tangent one (TL)\\
\hline
{\em y} & Model variable at time t \\
\hline
{\em propagator} & Propagator at time t \\
\hline
{\em t} & Actual integration time \\
\hline
{\em dt} & Integration timestep \\
\hline
{\em ynew} & Model variable at time t+dt \\
\hline
{\em adjoint} & If true, compute the propagator of the adjoint model (AD) instead of the tangent one (TL) \\
\hline
\end{DoxyParams}


Definition at line 193 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
193     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(INOUT)} :: t
194     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(IN)} :: dt
195     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(IN)} :: y
196     \textcolor{keywordtype}{LOGICAL}, \textcolor{keywordtype}{INTENT(IN)} :: adjoint
197     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(ndim,ndim)}, \textcolor{keywordtype}{INTENT(OUT)} :: propagator
198     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(OUT)} :: ynew
199  
200     \textcolor{keyword}{CALL }tendencies(t,y,buf\_f0)
201     buf\_j1=jacobian\_mat(y)
202 
203     buf\_y1 = y + dt*buf\_f0
204 
205     \textcolor{keyword}{CALL }tendencies(t+dt,buf\_y1,buf\_f1)
206     buf\_j2=jacobian\_mat(buf\_y1)
207     
208     buf\_j1h=buf\_j1
209     buf\_j2h=buf\_j2
210     \textcolor{keyword}{CALL }dgemm (\textcolor{stringliteral}{'n'}, \textcolor{stringliteral}{'n'}, ndim, ndim, ndim, dt, buf\_j2, ndim,buf\_j1h, ndim,1.0d0, buf\_j2h, ndim)
211      
212     ynew=y  + dt/2.0d0*(buf\_f0 + buf\_f1)
213     \textcolor{keywordflow}{IF} (adjoint) \textcolor{keywordflow}{THEN}
214             propagator=one - dt/2.0d0*(buf\_j1h + buf\_j2h)
215     \textcolor{keywordflow}{ELSE}
216             propagator=one + dt/2.0d0*(buf\_j1h + buf\_j2h)
217 \textcolor{keywordflow}{    END IF}        
218     t=t+dt
219    
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!tendencies@{tendencies}}
\index{tendencies@{tendencies}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{tendencies(t, y, res)}{tendencies(t, y, res)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine tl\+\_\+ad\+\_\+integrator\+::tendencies (
\begin{DoxyParamCaption}
\item[{real(kind=8), intent(in)}]{t, }
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{y, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{res}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_aa03be9677761cfa373b15c85cccdc424}{}\label{namespacetl__ad__integrator_aa03be9677761cfa373b15c85cccdc424}


Routine computing the tendencies of the nonlinear model. 


\begin{DoxyParams}{Parameters}
{\em t} & Time at which the tendencies have to be computed. Actually not needed for autonomous systems. \\
\hline
{\em y} & Point at which the tendencies have to be computed. \\
\hline
{\em res} & vector to store the result. \\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
Note that it is N\+OT safe to pass {\ttfamily y} as a result bufer, as this operation does multiple passes. 
\end{DoxyRemark}


Definition at line 60 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
60     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(IN)} :: t
61     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(IN)} :: y
62     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(OUT)} :: res
63     \textcolor{keyword}{CALL }sparse\_mul3(aotensor, y, y, res)
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!tl\+\_\+step@{tl\+\_\+step}}
\index{tl\+\_\+step@{tl\+\_\+step}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{tl\+\_\+step(y, ystar, t, dt, res)}{tl_step(y, ystar, t, dt, res)}}]{\setlength{\rightskip}{0pt plus 5cm}subroutine public tl\+\_\+ad\+\_\+integrator\+::tl\+\_\+step (
\begin{DoxyParamCaption}
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{y, }
\item[{real(kind=8), dimension(0\+:ndim), intent(in)}]{ystar, }
\item[{real(kind=8), intent(inout)}]{t, }
\item[{real(kind=8), intent(in)}]{dt, }
\item[{real(kind=8), dimension(0\+:ndim), intent(out)}]{res}
\end{DoxyParamCaption}
)}\hypertarget{namespacetl__ad__integrator_ac88b155557d4fc0bae70007fde3aef06}{}\label{namespacetl__ad__integrator_ac88b155557d4fc0bae70007fde3aef06}


Routine to perform an integration step (Heun algorithm) of the tangent linear model. The incremented time is returned. 

Routine to perform an integration step (R\+K4 algorithm) of the tangent linear model. The incremented time is returned.


\begin{DoxyParams}{Parameters}
{\em y} & Initial point. \\
\hline
{\em ystar} & Adjoint model at the point ystar. \\
\hline
{\em t} & Actual integration time \\
\hline
{\em dt} & Integration timestep. \\
\hline
{\em res} & Final point after the step. \\
\hline
\end{DoxyParams}


Definition at line 145 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
145     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(IN)} :: y,ystar
146     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(INOUT)} :: t
147     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{INTENT(IN)} :: dt
148     \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(0:ndim)}, \textcolor{keywordtype}{INTENT(OUT)} :: res
149 
150     \textcolor{keyword}{CALL }tl(t,ystar,y,buf\_f0)
151     buf\_y1 = y+dt*buf\_f0
152     \textcolor{keyword}{CALL }tl(t+dt,ystar,buf\_y1,buf\_f1)
153     res=y+0.5*(buf\_f0+buf\_f1)*dt
154     t=t+dt
\end{DoxyCode}


\subsection{Variable Documentation}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+f0@{buf\+\_\+f0}}
\index{buf\+\_\+f0@{buf\+\_\+f0}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+f0}{buf_f0}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+f0\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_ad0e2f29027e4317cae009ca0c4ad1b5a}{}\label{namespacetl__ad__integrator_ad0e2f29027e4317cae009ca0c4ad1b5a}


Buffer to hold tendencies at the initial position of the tangent linear model. 



Definition at line 35 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
35   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_f0\textcolor{comment}{ !< Buffer to hold tendencies at the initial position of
       the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+f00@{buf\+\_\+f00}}
\index{buf\+\_\+f00@{buf\+\_\+f00}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+f00}{buf_f00}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+f00\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_ac1d8e51e7ef84e4b5cbab851759fa983}{}\label{namespacetl__ad__integrator_ac1d8e51e7ef84e4b5cbab851759fa983}


Buffer to hold tendencies at the initial position of the tangent linear model. 



Definition at line 39 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
39   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_f00\textcolor{comment}{ !< Buffer to hold tendencies at the initial position
       of the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+f1@{buf\+\_\+f1}}
\index{buf\+\_\+f1@{buf\+\_\+f1}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+f1}{buf_f1}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+f1\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_ac466cd6f698dc9fed5fc3ab46f30b9a5}{}\label{namespacetl__ad__integrator_ac466cd6f698dc9fed5fc3ab46f30b9a5}


Buffer to hold tendencies at the intermediate position of the tangent linear model. 



Definition at line 36 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
36   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_f1\textcolor{comment}{ !< Buffer to hold tendencies at the intermediate
       position of the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+f11@{buf\+\_\+f11}}
\index{buf\+\_\+f11@{buf\+\_\+f11}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+f11}{buf_f11}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+f11\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_ad772309f6a78f335766cec48e65747ba}{}\label{namespacetl__ad__integrator_ad772309f6a78f335766cec48e65747ba}


Buffer to hold tendencies at the intermediate position of the tangent linear model. 



Definition at line 40 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
40   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_f11\textcolor{comment}{ !< Buffer to hold tendencies at the intermediate
       position of the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j1@{buf\+\_\+j1}}
\index{buf\+\_\+j1@{buf\+\_\+j1}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j1}{buf_j1}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j1\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_abf7d3c46036ca20cca151adc20a2fa14}{}\label{namespacetl__ad__integrator_abf7d3c46036ca20cca151adc20a2fa14}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 42 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
42   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j1\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j1h@{buf\+\_\+j1h}}
\index{buf\+\_\+j1h@{buf\+\_\+j1h}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j1h}{buf_j1h}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j1h\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a4ae89c821542838ecfc5ac3b7a76d5c1}{}\label{namespacetl__ad__integrator_a4ae89c821542838ecfc5ac3b7a76d5c1}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 44 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
44   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j1h\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for
       the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j2@{buf\+\_\+j2}}
\index{buf\+\_\+j2@{buf\+\_\+j2}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j2}{buf_j2}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j2\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a0ce53a275fcb35f76e2b34ee8d8df1ca}{}\label{namespacetl__ad__integrator_a0ce53a275fcb35f76e2b34ee8d8df1ca}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 43 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
43   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j2\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j2h@{buf\+\_\+j2h}}
\index{buf\+\_\+j2h@{buf\+\_\+j2h}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j2h}{buf_j2h}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j2h\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a2a5e4cbc6f573f1274e53cbb4607f5bb}{}\label{namespacetl__ad__integrator_a2a5e4cbc6f573f1274e53cbb4607f5bb}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 45 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
45   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j2h\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for
       the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j3@{buf\+\_\+j3}}
\index{buf\+\_\+j3@{buf\+\_\+j3}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j3}{buf_j3}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j3\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_afb500987b643ce33b2a549ba213221fc}{}\label{namespacetl__ad__integrator_afb500987b643ce33b2a549ba213221fc}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 42 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
42   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j3\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j3h@{buf\+\_\+j3h}}
\index{buf\+\_\+j3h@{buf\+\_\+j3h}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j3h}{buf_j3h}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j3h\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a9ead2c02f871be0e94e91278fa71337c}{}\label{namespacetl__ad__integrator_a9ead2c02f871be0e94e91278fa71337c}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 46 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
46   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j3h\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for
       the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j4@{buf\+\_\+j4}}
\index{buf\+\_\+j4@{buf\+\_\+j4}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j4}{buf_j4}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j4\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a853bee458e7337f1556f19370dcbc9d6}{}\label{namespacetl__ad__integrator_a853bee458e7337f1556f19370dcbc9d6}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 43 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
43   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j4\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+j4h@{buf\+\_\+j4h}}
\index{buf\+\_\+j4h@{buf\+\_\+j4h}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+j4h}{buf_j4h}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+j4h\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a99c2747c1997b622f4ab6170e3a8f23d}{}\label{namespacetl__ad__integrator_a99c2747c1997b622f4ab6170e3a8f23d}


Buffer to hold jacobians in the R\+K4 scheme for the tangent linear model. 



Definition at line 47 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
47   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_j4h\textcolor{comment}{ !< Buffer to hold jacobians in the RK4 scheme for
       the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+ka@{buf\+\_\+ka}}
\index{buf\+\_\+ka@{buf\+\_\+ka}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+ka}{buf_ka}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+ka\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a879cc86c1e268775237b6776a4ff7d32}{}\label{namespacetl__ad__integrator_a879cc86c1e268775237b6776a4ff7d32}


Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. 



Definition at line 35 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
35   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_ka\textcolor{comment}{ !< Buffer to hold tendencies in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+kaa@{buf\+\_\+kaa}}
\index{buf\+\_\+kaa@{buf\+\_\+kaa}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+kaa}{buf_kaa}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+kaa\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a24b147c589eb6bdb6175c56657aff5ae}{}\label{namespacetl__ad__integrator_a24b147c589eb6bdb6175c56657aff5ae}


Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. 



Definition at line 48 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
48   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_kaa\textcolor{comment}{ !< Buffer to hold tendencies in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+kb@{buf\+\_\+kb}}
\index{buf\+\_\+kb@{buf\+\_\+kb}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+kb}{buf_kb}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+kb\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_abd6a1c209bc0120ea4e1e473e067a902}{}\label{namespacetl__ad__integrator_abd6a1c209bc0120ea4e1e473e067a902}


Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. 



Definition at line 36 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
36   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_kb\textcolor{comment}{ !< Buffer to hold tendencies in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+kbb@{buf\+\_\+kbb}}
\index{buf\+\_\+kbb@{buf\+\_\+kbb}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+kbb}{buf_kbb}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+kbb\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a68ad95731421a7e0c9f37668631e279c}{}\label{namespacetl__ad__integrator_a68ad95731421a7e0c9f37668631e279c}


Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. 



Definition at line 49 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
49   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_kbb\textcolor{comment}{ !< Buffer to hold tendencies in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+kc@{buf\+\_\+kc}}
\index{buf\+\_\+kc@{buf\+\_\+kc}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+kc}{buf_kc}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+kc\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a1cf59efa7229b47e580202dfe4bd4fd6}{}\label{namespacetl__ad__integrator_a1cf59efa7229b47e580202dfe4bd4fd6}


Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. 



Definition at line 38 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
38   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_kc\textcolor{comment}{ !< Buffer to hold tendencies in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+kd@{buf\+\_\+kd}}
\index{buf\+\_\+kd@{buf\+\_\+kd}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+kd}{buf_kd}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+kd\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a3b72ebc24a7e0eb44e22e6489ac81ed3}{}\label{namespacetl__ad__integrator_a3b72ebc24a7e0eb44e22e6489ac81ed3}


Buffer to hold tendencies in the R\+K4 scheme for the tangent linear model. 



Definition at line 39 of file rk4\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
39   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_kd\textcolor{comment}{ !< Buffer to hold tendencies in the RK4 scheme for the
       tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+y1@{buf\+\_\+y1}}
\index{buf\+\_\+y1@{buf\+\_\+y1}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+y1}{buf_y1}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+y1\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a54c26282330477995b554805fbacf236}{}\label{namespacetl__ad__integrator_a54c26282330477995b554805fbacf236}


Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model. 

Buffer to hold the intermediate position of the tangent linear model. 

Definition at line 34 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
34   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_y1\textcolor{comment}{ !< Buffer to hold the intermediate position (Heun
       algorithm) of the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!buf\+\_\+y11@{buf\+\_\+y11}}
\index{buf\+\_\+y11@{buf\+\_\+y11}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{buf\+\_\+y11}{buf_y11}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::buf\+\_\+y11\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_ae17c25e2843c5f18b69c133ccca1d483}{}\label{namespacetl__ad__integrator_ae17c25e2843c5f18b69c133ccca1d483}


Buffer to hold the intermediate position (Heun algorithm) of the tangent linear model. 

Buffer to hold the intermediate position of the tangent linear model. 

Definition at line 38 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
38   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:)}, \textcolor{keywordtype}{ALLOCATABLE} :: buf\_y11\textcolor{comment}{ !< Buffer to hold the intermediate position (Heun
       algorithm) of the tangent linear model}
\end{DoxyCode}
\index{tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}!one@{one}}
\index{one@{one}!tl\+\_\+ad\+\_\+integrator@{tl\+\_\+ad\+\_\+integrator}}
\subsubsection[{\texorpdfstring{one}{one}}]{\setlength{\rightskip}{0pt plus 5cm}real(kind=8), dimension(\+:,\+:), allocatable tl\+\_\+ad\+\_\+integrator\+::one\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{namespacetl__ad__integrator_a08f375467a942d0ad466b407a8007a7e}{}\label{namespacetl__ad__integrator_a08f375467a942d0ad466b407a8007a7e}


unit matrix 



Definition at line 46 of file rk2\+\_\+tl\+\_\+ad\+\_\+integrator.\+f90.


\begin{DoxyCode}
46   \textcolor{keywordtype}{REAL(KIND=8)}, \textcolor{keywordtype}{DIMENSION(:,:)}, \textcolor{keywordtype}{ALLOCATABLE} :: one\textcolor{comment}{        !< unit matrix }
\end{DoxyCode}
